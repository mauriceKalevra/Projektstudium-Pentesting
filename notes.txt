Define the scope:!
Grey-Box 
aggresive
focused
overt
network

Zielgerät:
-Homematic
- Läuft auf Rasperry Pie 3b 2015
- Ist einfach zugänglich
- Custom board mit Wlan modul/antenne

Gefundene Schachstellen:
Session stealing: Bei Anmeldung wird eine Session angelegt, die auch in der Url einsehbar ist. Gelangt man an diese Session ID kann man sich mit dieser von jedem beliebigen Gerät einlogen. Zudem bleibt die Session selbst nach Schließen des Fensters für 300 sekunden inaktivität lang gültig!

Default Authentifizierung ist Admin:Admin, welche in jeder wordlist vorhanden sind!

Die Authentifizierung hat kein cooldown und wird zudem nicht gelockt! ---> Brute-Force ist möglich!

Software updatet sich nicht automatisch!

Das Passwort wird mit sha512 gehashed, ohne Salt.
Der Hash ist zudem als User direkt einsehbar!

Default Protokoll ist HTTP

HTTP Security Header wie Csp, Hsts Fehlen..

Remote Code Execution ist möglich: CVE-2019-15850: Remote Code Execution in HomeMatic central CCU3
--> https://noskill1337.github.io/homematic-ccu3-remote-code-execution

SSH ist als Admin einrichtbar mit Passwort vergabe...
ssh root@141.87.29.101
benutzer ist root
SSH ist zudem mit einem einfachen python skript anzugreifen.
Da ssh keine timeouts hat!
Man hat 100% zugriff auf jegliche Files und configs...


Durch das CCU update menü ist es möglich eigene Software hochzuladen... mit entsprechender Formatierung ist es so möglich Schadware hochzuladen!

OSINT:

